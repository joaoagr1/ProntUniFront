<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Prontuni</title>
  <link rel="icon" href="./prontuniIcon.png" type="image/x-icon">
  <link rel="stylesheet" type="text/css" href="css/reset.css">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    crossorigin="anonymous">

  <link rel="stylesheet" type="text/css" href="/css/index.css">

</head>

<body>

  <head>
    <nav class="navbar navbar-dark">
      <div class="container">
        <a class="navbar-brand font-weight-bold mx-auto" href="#">
          <h1>PronTuni</h1>
        </a>
      </div>
    </nav>
  </head>

  <section id="section-principal" style="background-color: #eee;">

    <div class="container py-5">

      <div class="row">
        <div class="col">

        </div>
      </div>

      <div class="row">
        <div class="col-lg-4">
          <div class="card mb-4">

            <div class="card-body text-center">

              <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3.webp" alt="avatar"
                class="rounded-circle img-fluid" style="width: 150px;">
              <h5 id="primeiro-nome" class="my-3">John Smith</h5>
              <p class="text-muted mb-1"></p>
              <p class="text-muted mb-4"></p>
              <div class="d-flex justify-content-center mb-2">

              </div>
            </div>
          </div>
          <div class="card mb-4 mb-lg-0">
            <div class="card-body p-0">
              <ul class="list-group list-group-flush rounded-3">
                <li class="list-group-item d-flex  align-items-center p-3">
                  <i class="fas fa-globe fa-lg text-warning"></i>
                  <p id="cidade" class="mb-0">Maringá</p>
                </li>
                <li class="list-group-item d-flex align-items-center p-3">
                  <i class="fab fa-github fa-lg" style="color: #333333;"></i>
                  <p id="bairro" class="mb-0">Zona 2</p>
                </li>
                <li class="list-group-item d-flex  align-items-center p-3">
                  <i class="fab fa-twitter fa-lg" style="color: #55acee;"></i>
                  <p id="logradouro" class="mb-0">Avenida São Paulo</p>
                </li>
                <li class="list-group-item d-flex align-items-center p-3">
                  <i class="fab fa-instagram fa-lg" style="color: #ac2bac;"></i>
                  <p id="numero" class="mb-0" 356>356</p>
                </li>
                <li class="list-group-item d-flex align-items-center p-3">
                  <i class="fab fa-facebook-f fa-lg" style="color: #3b5998;"></i>
                  <p id="complemento" class="mb-0">Ap. 23</p>
                </li>
              </ul>
            </div>
          </div>
          <button id="botao-excluir-detalhe" class="btn btn-danger">Excluir</button>
          <button id="botao-editar-detalhe" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#editarModal"
            data-bs-whatever="">Editar</button>
        </div>
        <div class="col-lg-8">
          <div class="card mb-4">
            <div class="card-body">
              <div class="row">
                <div class="col-sm-3">
                  <p class="mb-0">Nome Completo</p>
                </div>
                <div class="col-sm-9">
                  <p id="nome-detalhe" class="text-muted mb-0">Johnatan Smith</p>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-sm-3">
                  <p class="mb-0">Email</p>
                </div>
                <div class="col-sm-9">
                  <p id="email-detalhe" class="text-muted mb-0">example@example.com</p>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-sm-3">
                  <p class="mb-0">CRM</p>
                </div>
                <div class="col-sm-9">
                  <p id="crm-detalhe" class="text-muted mb-0">(097) 234-5678</p>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-sm-3">
                  <p class="mb-0">Especialidade</p>
                </div>
                <div class="col-sm-9">
                  <p id="especialidade-detalhe" class="text-muted mb-0">(098) 765-4321</p>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-sm-3">
                  <p class="mb-0">Telefone</p>
                </div>
                <div class="col-sm-9">
                  <p id="telefone-detalhe" class="text-muted mb-0"></p>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="card mb-4 mb-md-0">
                <div class="card-body">
                  <div class="tabela-detalhes">
                    <table id="tabelaMuc" class="">
                      <thead>
                        <tr>
                          <th>Muc</th>

                        </tr>
                      </thead>

                      <tbody id="tbody-muc">

                      </tbody>
                    </table>

                  </div>

                  <div>
                    <input class="mt-3" type="text" id="campo-texto-muc" name="nome">
                    <button id="botao-muc" type="button" class="btn btn-success font-weight-bold"></button>
                  </div>

                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card mb-4 mb-md-0">
                <div class="card-body">
                  <div class="tabela-detalhes">
                    <table id="tabelaAlergias" class="">
                      <thead>
                        <tr>
                          <th>Alergias</th>

                        </tr>
                      </thead>

                      <tbody id="tbody">

                      </tbody>
                    </table>


                  </div>
                  <div>
                    <input class="mt-3" type="text" id="campo-texto-alergias" name="nome">
                    <button id="botao-alergias" type="button" class="btn btn-success font-weight-bold"></button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

  </section>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"></script>
  <script src="js/selecionaTr.js" crossorigin="anonymous"></script>
  <script src="js/forms-detalhes.js" crossorigin="anonymous"></script>
  <script src="js/excluir-detalhes.js" crossorigin="anonymous"></script>


  <script>

    document.addEventListener("DOMContentLoaded", function () {
      let valor = localStorage.getItem("detalheStorage");
      console.log(valor);
      // Faça algo com o valor recuperado

      fetch(`http://localhost:8080/medicos/${valor}`, {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json', // Defina os cabeçalhos apropriados, se necessário
          // Outros cabeçalhos, se necessário
        },
      })
        .then(response => {
          if (!response.ok) {
            throw new Error('Não foi possível obter os dados.');
          }
          return response.json(); // Se a resposta for JSON
          // Se a resposta não for JSON, use response.text() ou response.blob(), dependendo do tipo de resposta.
        })
        .then(data => {
          // Faça algo com os dados recebidos, por exemplo, exiba no console
          console.log(data);
          console.log(data.nome)

          document.querySelector('#nome-detalhe').textContent = data.nome;
          document.querySelector('#email-detalhe').textContent = data.email;
          document.querySelector('#crm-detalhe').textContent = data.crm;
          document.querySelector('#especialidade-detalhe').textContent = data.especialidade;
          document.querySelector('#telefone-detalhe').textContent = data.telefone;
          document.querySelector('#cidade').textContent = "Cidade: "+data.endereco.cidade;
          document.querySelector('#bairro').textContent = "Bairro: "+data.endereco.bairro;
          document.querySelector('#logradouro').textContent = "Logradouro: "+ data.endereco.logradouro;
          document.querySelector('#numero').textContent = "Número: "+data.endereco.numero;
          document.querySelector('#complemento').textContent = "UF: "+data.endereco.uf;

          var primeiroNome = data.nome.match(/\S+(?=\s)/);
  

          console.log(primeiroNome)

          document.querySelector('#primeiro-nome').textContent = primeiroNome;








        })
        .catch(error => {
          console.error('Ocorreu um erro:', error);
        });


    });

    valor = localStorage.getItem("detalheStorage");



    const url = `http://localhost:8080/alergias/identificador?identificador=${valor}`;

    // Fazer a requisição GET
    fetch(url)
      .then(response => {
        if (!response.ok) {
          throw new Error('Erro na requisição.');
        }
        return response.json(); // Parse a resposta JSON
      })
      .then(data => {
        // Os dados da resposta estarão em 'data'
        let tabelaAlergias = document.querySelector("#tbody");
        for (let i = 0; i < data.length; i++) {
          let tr = tbody.insertRow();
          let tdAlergias = tr.insertCell();



          tdAlergias.innerText = data[i].alergia;
        }

        console.log(data);
      })
      .catch(error => {
        console.error('Erro:', error);
      });


    const novaurl = `http://localhost:8080/muc/identificador?identificador=${valor}`;

    // Fazer a requisição GET
    fetch(novaurl)
      .then(response => {
        if (!response.ok) {
          throw new Error('Erro na requisição.');
        }
        return response.json(); // Parse a resposta JSON
      })
      .then(data => {
        // Os dados da resposta estarão em 'data'
        let tabelaMuc = document.querySelector("#tbody-muc");
        for (let i = 0; i < data.length; i++) {
          let tr = tabelaMuc.insertRow();
          let tdMuc = tr.insertCell();



          tdMuc.innerText = data[i].muc;
        }

        console.log(data);
      })
      .catch(error => {
        console.error('Erro:', error);
      });







  </script>

</body>

</html>